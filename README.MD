# Clean Track RIWI - Sistema de Gestión de Limpieza

Clean Track RIWI es una aplicación web completa diseñada para la gestión y monitoreo eficiente de tareas de limpieza en instalaciones. La plataforma cuenta con dos roles principales: Administradores, que gestionan zonas, usuarios y asignaciones; y Empleados, que registran sus actividades de limpieza a través de un sistema de validación por QR.

El sistema proporciona un monitor en tiempo real del estado de las zonas, un sistema de reportes de productividad y un historial completo de todas las actividades, garantizando un control total sobre la operación.



## ✨ Características Principales

El sistema está diseñado con dos roles principales, cada uno con un conjunto de herramientas específicas para maximizar la eficiencia y el control.

### Para Administradores:

*   **Dashboard Interactivo:** Visualización de estadísticas clave en tiempo real, incluyendo limpiezas del día, zonas pendientes y colaboradores activos.
*   **Gestión de Zonas (CRUD):** Permite crear, editar y eliminar zonas de limpieza, asignando a cada una un identificador QR único y una foto de referencia para fácil identificación.
*   **Gestión de Usuarios (CRUD):** Administra usuarios con roles de "Admin" o "Empleado". Puedes crear, editar, eliminar y gestionar su estado (Activo/Inactivo).
*   **Gestión de Asignaciones:** Asigna zonas a empleados de forma manual o utiliza una función de **asignación aleatoria** para distribuir las tareas equitativamente.
*   **Monitor de Zonas en Tiempo Real:** Un mapa interactivo que muestra el estado de cada zona (Verde: Limpio, Rojo: Pendiente) con un límite de tiempo configurable (por defecto 6 horas) para el reinicio del estado.
*   **Generador de Reportes:** Un potente sistema de filtrado por fechas y tipo de reporte que permite analizar la productividad por empleado o consultar el historial general de limpieza.
*   **Generador de Códigos QR:** Genera e imprime los códigos QR únicos para cada zona, listos para ser colocados físicamente en el lugar.

### Para Empleados:

*   **Dashboard Personalizado:** Una vista clara y concisa de las zonas asignadas para la jornada laboral, mostrando el estado actual de cada una.
*   **Registro de Limpieza Seguro:** Un sistema de validación mediante escaneo de QR que garantiza que el empleado se encuentre físicamente en la zona correcta antes de registrar una limpieza.
*   **Subida de Evidencias:** Permite capturar y subir una fotografía como prueba irrefutable del trabajo realizado. Las imágenes se almacenan de forma segura en la nube.
*   **Perfil de Usuario:** Acceso a la información personal y de trabajo registrada en el sistema.

## 🛠️ Tecnologías Utilizadas

La aplicación utiliza un conjunto de tecnologías modernas y eficientes, seleccionadas para construir una solución robusta, escalable y segura.

| Capa | Tecnología | Propósito en el Proyecto |
| :--- | :--- | :--- |
| **Frontend** | **HTML5, CSS3 y JavaScript (ES6+)** | Pilares del desarrollo web para la estructura, diseño y lógica interactiva del cliente. |
| | **Bootstrap 5** | Acelera el desarrollo de la interfaz de usuario con un diseño responsivo y mobile-first. |
| | **SweetAlert2** | Proporciona notificaciones y alertas modales atractivas y personalizadas para el usuario. |
| | **Chart.js** | Visualiza métricas clave del sistema mediante gráficos interactivos en el dashboard de administrador. |
| | **QRCode.js** | Permite la generación dinámica de códigos QR para cada zona de limpieza. |
| **Backend** | **Node.js con Express.js** | Entorno de ejecución y framework para construir una API RESTful de alto rendimiento. |
| | **JWT (JSON Web Tokens)** | Gestiona la autenticación segura y sin estado para proteger las rutas de la API. |
| | **bcrypt** | Hashea de forma segura las contraseñas de los usuarios para garantizar que nunca se almacenen en texto plano. |
| | **Multer y Multer-S3** | Se utilizan en conjunto para procesar la subida de archivos y almacenarlos directamente en el servicio de nube de AWS S3. |
| | **Nodemailer** | Se encarga del envío de correos electrónicos transaccionales, como los de recuperación de contraseña. |
| **Base de Datos y<br>Almacenamiento** | **PostgreSQL** | Es el sistema de gestión de base de datos relacional para el almacenamiento estructurado y persistente de toda la información. |
| | **AWS S3** | Servicio de almacenamiento de objetos en la nube, optimizado para guardar las fotos de evidencia y de zonas, manteniendo el servidor ligero y escalable. |

---

## 📂 Estructura del Proyecto
Aquí tienes una visión general de la estructura de carpetas y archivos para entender cómo se organiza el proyecto.
```
├── back-end/
│   ├── node_modules/                 # Dependencias del backend (Node.js)
│   ├── .env                          # Variables de entorno para la configuración
│   ├── app.js                        # Lógica principal del servidor Express
│   ├── db.js                         # Configuración y conexión a PostgreSQL
│   ├── package-lock.json             # Bloqueo de las versiones de dependencias
│   └── package.json                  # Lista de dependencias del backend
├── data/
│   └── db.sql                        # Archivo SQL con el esquema de la base de datos
├── docs/                             # Documentación del proyecto
│   └── MER/                          # Modelo Entidad-Relación
│       └── (Imágenes)                # Imágenes del diagrama MER
├── front-end/
│   ├── css/                          # Hojas de estilo CSS
│   │   ├── dashboard_admin.css
│   │   ├── styles.css
│   │   └── zonas_employee.css
│   ├── html/                         # Páginas HTML del sitio
│   │   ├── change_password.html      # Página para cambiar la contraseña
│   │   ├── dashboard_admin.html      # Panel principal del administrador
│   │   ├── index.html                # Página de inicio (login)
│   │   └── zones_employee.html       # Panel del empleado
│   ├── img/                          # Imágenes y activos del frontend
│   └── js/                           # Archivos JavaScript
│       ├── api.js                    # Lógica para las llamadas a la API
│       ├── auth-controller.js        # Lógica para la autenticación
│       ├── main.js                   # Lógica del dashboard del administrador
│       ├── reset-password.js         # Lógica para restablecer la contraseña
│       ├── service-worker.js         # Service Worker para la funcionalidad offline
│       └── zones_employee.js         # Lógica del portal del empleado
├── .gitignore                        # Archivo para ignorar directorios y archivos de Git
├── README.md                         # Descripción del proyecto
├── manifest.json                     # Manifiesto de la aplicación web (PWA)
└── package.json                      # Lista de dependencias del proyecto (root)
```

## 🚀 Guía de Instalación y Puesta en Marcha

Sigue estos pasos para clonar, configurar y ejecutar el proyecto en tu entorno local.

### 1. Prerrequisitos

Asegúrate de tener instalado el siguiente software en tu máquina:

*   **Node.js** (versión 18.x o superior)
*   **npm** (generalmente se instala con Node.js)
*   Un cliente de **PostgreSQL** como DBeaver o pgAdmin.
*   **Git** para clonar el repositorio.
*   Una cuenta de **AWS** para crear un bucket S3.
*   Una cuenta de **Gmail** con la "Verificación en 2 pasos" activada para generar una contraseña de aplicación.

### 2. Descarga del Proyecto

Clona el repositorio desde GitHub a tu máquina local:

```bash
git clone https://github.com/alejo11102001/CLEAN_TRACK_RIWI
cd CLEAN_TRACK_RIWI
```

### 3. Configuración del Backend

Navega a la carpeta del backend:

```bash
cd back-end
```

Instala todas las dependencias del proyecto:

```bash
npm install
npm i
```

Crea un archivo `.env` en la raíz de la carpeta `back-end` y añade las siguientes variables. Este archivo es crucial para guardar tus claves secretas.

```env
### Configuración de la Base de Datos PostgreSQL
PGHOST=168.119.183.3
PGPORT=5432
PGDATABASE=clean_track_riwi
PGUSER=root
PGPASSWORD=s7cq453mt2jnicTaQXKT

```

### 4. Configuración de la Base de Datos

1.  Abre tu cliente de PostgreSQL (DBeaver/pgAdmin).
2.  Crea una nueva base de datos con el nombre que especificaste en tu archivo `.env` (ej: `clean_track_riwi`).
3.  Ejecuta el script SQL `db.sql` para crear todas las tablas, tipos y relaciones necesarias.

### 5. Iniciar la Aplicación

Debes iniciar tanto el servidor del backend como el del frontend.

### Iniciar el Backend:

Abre una terminal en la carpeta `back-end` y ejecuta:

```bash
node app.js
```

Si todo está bien, verás el mensaje: `Servidor corriendo en http://localhost:3000`.

### Iniciar el Frontend:

1.  Abre la carpeta `front-end` en Visual Studio Code.
2.  Asegúrate de tener la extensión **"Live Server"** instalada.
3.  Haz clic derecho en tu archivo `index.html`y selecciona **"Open with Live Server"**.
4.  Esto abrirá tu aplicación en el navegador, generalmente en `http://127.0.0.1:5500`.

---
## 🧑‍💻 Credenciales de Ejemplo

Puedes usar las siguientes credenciales para iniciar sesión en la aplicación.

### Administrador
*   **Usuario:** `diego.zuluagaye@amigo.edu.co`
*   **Contraseña:** `Diego12345@`

### Empleado
*   **Usuario:** `jerorrpo@gmail.com`
*   **Contraseña:** `jero12345`

---

# ☁️ Despliegue

La aplicación está diseñada para ser desplegada en servicios modernos con capas gratuitas.

*   **Base de Datos (PostgreSQL):** Se recomienda [Neon](https://neon.tech/).
*   **Backend (Node.js API):** Se recomienda [Render](https://render.com/). No olvides configurar todas las variables de entorno en el panel de Render.
*   **Frontend (Sitio Estático):** Se recomienda [Netlify](https://www.netlify.com/) o [Vercel](https://vercel.com/).

## Pasos post-despliegue:

1.  Actualiza la variable `API_BASE_URL` en tu archivo `front-end/js/api.js` para que apunte a la URL de tu backend en Render.
2.  Actualiza la variable `resetLink` en tu `app.js` para que apunte a la URL de tu frontend en Netlify.
3.  Actualiza la política de CORS de tu bucket S3 para permitir peticiones desde tu nueva URL de Netlify.

---
## 🔗 Link Despliegue

Puedes acceder a la versión en producción aquí:
**[https://vocal-peony-3f0286.netlify.app/](https://vocal-peony-3f0286.netlify.app/)**

# ✒️ Autores

*   Abrahan Taborda
*   Jeronimo Rodriguez
*   Emmanuel Jaramillo
*   Luis Ducuara
*   Diego Zuluaga

*coders Van-rossum*
## ¡Gracias por revisar este proyecto!

# README IN ENGLISH

# Clean Track RIWI - Cleaning Management System

Clean Track RIWI is a comprehensive web application designed for the efficient management and monitoring of cleaning tasks in facilities. The platform features two main roles: Administrators, who manage zones, users, and assignments; and Employees, who log their cleaning activities through a QR validation system.

The system provides a real-time monitor of zone statuses, a productivity reporting system, and a complete history of all activities, ensuring full control over the operation.

## ✨ Main Features

The system is designed with two main roles, each with a specific set of tools to maximize efficiency and control.

### For Administrators:

*   **Interactive Dashboard:** Real-time visualization of key statistics, including daily cleanings, pending zones, and active employees.
*   **Zone Management (CRUD):** Allows creating, editing, and deleting cleaning zones, assigning each a unique QR identifier and a reference photo for easy identification.
*   **User Management (CRUD):** Manage users with "Admin" or "Employee" roles. You can create, edit, delete, and manage their status (Active/Inactive).
*   **Assignment Management:** Assign zones to employees manually or use a **random assignment** feature to distribute tasks equitably.
*   **Real-Time Zone Monitoring:** An interactive map that displays the status of each zone (Green: Clean, Red: Pending) with a configurable time limit (default is 6 hours) for status reset.
*   **Report Generator:** A powerful filtering system by date and report type that allows analyzing productivity per employee or consulting the overall cleaning history.
*   **QR Code Generator:** Generates and prints unique QR codes for each zone, ready to be placed physically on-site.

### For Employees:

*   **Personalized Dashboard:** A clear and concise view of the zones assigned for the workday, showing the current status of each.
*   **Secure Cleaning Log:** A validation system using QR scanning to ensure the employee is physically in the correct zone before logging a cleaning.
*   **Evidence Upload:** Allows capturing and uploading a photograph as irrefutable proof of the work done. Images are stored securely in the cloud.
*   **User Profile:** Access to personal and work information registered in the system.

## 🛠️ Technologies Used

The application uses a set of modern and efficient technologies, selected to build a robust, scalable, and secure solution.

| Layer | Technology | Purpose in the Project |
| :--- | :--- | :--- |
| **Frontend** | **HTML5, CSS3 & JavaScript (ES6+)** | The pillars of web development for structure, design, and interactive client-side logic. |
| | **Bootstrap 5** | Accelerates UI development with a responsive and mobile-first design. |
| | **SweetAlert2** | Provides attractive and customized modal notifications and alerts for the user. |
| | **Chart.js** | Visualizes key system metrics through interactive charts on the admin dashboard. |
| | **QRCode.js** | Enables the dynamic generation of QR codes for each cleaning zone. |
| **Backend** | **Node.js with Express.js** | Runtime environment and framework for building a high-performance RESTful API. |
| | **JWT (JSON Web Tokens)** | Manages secure, stateless authentication to protect API routes. |
| | **bcrypt** | Securely hashes user passwords to ensure they are never stored in plain text. |
| | **Multer and Multer-S3** | Used together to process file uploads and store them directly in the AWS S3 cloud service. |
| | **Nodemailer** | Handles the sending of transactional emails, such as password recovery emails. |
| **Database &<br>Storage** | **PostgreSQL** | The relational database management system for structured and persistent storage of all information. |
| | **AWS S3** | Cloud object storage service, optimized for saving evidence and zone photos, keeping the server light and scalable. |

---

## 📂 Project Structure
Here is an overview of the folder and file structure to understand how the project is organized.
```
├── back-end/
│   ├── node_modules/                 # Backend dependencies (Node.js)
│   ├── .env                          # Environment variables for configuration
│   ├── app.js                        # Main Express server logic
│   ├── db.js                         # PostgreSQL configuration and connection
│   ├── package-lock.json             # Locks dependency versions
│   └── package.json                  # List of backend dependencies
├── data/
│   └── db.sql                        # SQL file with the database schema
├── docs/                             # Project documentation
│   └── MER/                          # Entity-Relationship Model
│       └── (Images)                  # ERD images
├── front-end/
│   ├── css/                          # CSS stylesheets
│   │   ├── dashboard_admin.css
│   │   ├── styles.css
│   │   └── zonas_employee.css
│   ├── html/                         # HTML pages of the site
│   │   ├── change_password.html      # Page to change password
│   │   ├── dashboard_admin.html      # Admin's main dashboard
│   │   ├── index.html                # Home page (login)
│   │   └── zones_employee.html       # Employee's dashboard
│   ├── img/                          # Frontend images and assets
│   └── js/                           # JavaScript files
│       ├── api.js                    # Logic for API calls
│       ├── auth-controller.js        # Authentication logic
│       ├── main.js                   # Admin dashboard logic
│       ├── reset-password.js         # Password reset logic
│       ├── service-worker.js         # Service Worker for offline functionality
│       └── zones_employee.js         # Employee portal logic
├── .gitignore                        # File to ignore Git directories and files
├── README.md                         # Project description
├── manifest.json                     # Web application manifest (PWA)
└── package.json                      # Project dependencies list (root)
```

## 🚀 Installation and Setup Guide

Follow these steps to clone, configure, and run the project in your local environment.

### 1. Prerequisites

Make sure you have the following software installed on your machine:

*   **Node.js** (version 18.x or higher)
*   **npm** (usually installed with Node.js)
*   A **PostgreSQL** client like DBeaver or pgAdmin.
*   **Git** to clone the repository.
*   An **AWS** account to create an S3 bucket.
*   A **Gmail** account with "2-Step Verification" enabled to generate an app password.

### 2. Download the Project

Clone the repository from GitHub to your local machine:

```bash
git clone https://github.com/alejo11102001/CLEAN_TRACK_RIWI
cd CLEAN_TRACK_RIWI
```

### 3. Backend Configuration

Navigate to the backend folder:

```bash
cd back-end
```

Install all project dependencies:

```bash
npm install
```

Create a `.env` file in the root of the `back-end` folder and add the following variables. This file is crucial for storing your secret keys.

```env
### PostgreSQL Database Configuration
PGHOST=168.119.183.3
PGPORT=5432
PGDATABASE=clean_track_riwi
PGUSER=root
PGPASSWORD=s7cq453mt2jnicTaQXKT
```

### 4. Database Setup

1.  Open your PostgreSQL client (DBeaver/pgAdmin).
2.  Create a new database with the name you specified in your `.env` file (e.g., `clean_track_riwi`).
3.  Run the `db.sql` script to create all the necessary tables, types, and relationships.

### 5. Running the Application

You need to start both the backend and frontend servers.

#### Start the Backend:

Open a terminal in the `back-end` folder and run:

```bash
node app.js
```

If everything is correct, you will see the message: `Server running on http://localhost:3000`.

#### Start the Frontend:

1.  Open the `front-end` folder in Visual Studio Code.
2.  Make sure you have the **"Live Server"** extension installed.
3.  Right-click on your `index.html` file and select **"Open with Live Server"**.
4.  This will open your application in the browser, usually at `http://127.0.0.1:5500`.

---
## 🧑‍💻 Sample Credentials

You can use the following credentials to log in to the application.

### Administrator
*   **User:** `diego.zuluagaye@amigo.edu.co`
*   **Password:** `Diego12345@`

### Employee
*   **User:** `jerorrpo@gmail.com`
*   **Password:** `jero12345`

---

# ☁️ Deployment

The application is designed to be deployed on modern services with free tiers.

*   **Database (PostgreSQL):** [Neon](https://neon.tech/) is recommended.
*   **Backend (Node.js API):** [Render](https://render.com/) is recommended. Don't forget to set all environment variables in the Render dashboard.
*   **Frontend (Static Site):** [Netlify](https://www.netlify.com/) or [Vercel](https://vercel.com/) are recommended.

## Post-deployment Steps:

1.  Update the `API_BASE_URL` variable in your `front-end/js/api.js` file to point to your backend URL on Render.
2.  Update the `resetLink` variable in your `app.js` to point to your frontend URL on Netlify.
3.  Update the CORS policy of your S3 bucket to allow requests from your new Netlify URL.

---
## 🔗 Deployment Link

You can access the production version here:
**[https://vocal-peony-3f0286.netlify.app/](https://vocal-peony-3f0286.netlify.app/)**

# ✒️ Authors

*   Abrahan Taborda
*   Jeronimo Rodriguez
*   Emmanuel Jaramillo
*   Luis Ducuara
*   Diego Zuluaga

*coders Van-rossum*

# Thank you for reviewing this project!
